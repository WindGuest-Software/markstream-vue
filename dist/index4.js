var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(o,t,n)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,r=(e,o)=>{for(var t in o||(o={}))l.call(o,t)&&a(e,t,o[t]);if(n)for(var t of n(o))i.call(o,t)&&a(e,t,o[t]);return e},u=(e,n)=>o(e,t(n)),s=(e,o,t)=>new Promise((n,l)=>{var i=e=>{try{r(t.next(e))}catch(o){l(o)}},a=e=>{try{r(t.throw(e))}catch(o){l(o)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,a);r((t=t.apply(e,o)).next())});import{defineComponent as c,computed as d,onMounted as v,onUnmounted as m,createBlock as p,openBlock as h,Teleport as f,createElementVNode as w,normalizeClass as g,withModifiers as y,toDisplayString as b,unref as k,getCurrentInstance as x,ref as M,watch as C,onBeforeUnmount as S,nextTick as B,createElementBlock as O,normalizeStyle as _,createCommentVNode as F,withDirectives as P,renderSlot as E,Fragment as T,vShow as z}from"vue";import{u as N,_ as j,n as H,r as $,a as D,g as L,l as Y,b as W,c as V,s as q,h as I}from"./exports.js";import{s as R}from"./safeRaf.js";const X={class:"markstream-vue"},A={class:"html-preview-frame__header"},G={class:"html-preview-frame__title"},J={class:"html-preview-frame__label"},U=["srcdoc"],K=/* @__PURE__ */j(/* @__PURE__ */c({__name:"HtmlPreviewFrame",props:{code:{},isDark:{type:Boolean},onClose:{type:Function},title:{}},setup(e){const o=e,{t}=N(),n=d(()=>{const e=o.code||"",t=e.trim().toLowerCase();return t.startsWith("<!doctype")||t.startsWith("<html")||t.startsWith("<body")?e:`<!doctype html>\n<html lang="en">\n  <head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1" />\n    <style>\n      html, body {\n        margin: 0;\n        padding: 0;\n        height: 100%;\n        background-color: ${o.isDark?"#020617":"#ffffff"};\n        color: ${o.isDark?"#e5e7eb":"#020617"};\n      }\n      body {\n        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'SF Pro Text', ui-sans-serif, sans-serif;\n      }\n    </style>\n  </head>\n  <body>\n    ${e}\n  </body>\n</html>`});function l(e){var t;"Escape"!==e.key&&"Esc"!==e.key||null==(t=o.onClose)||t.call(o)}return v(()=>{"undefined"!=typeof window&&window.addEventListener("keydown",l)}),m(()=>{"undefined"!=typeof window&&window.removeEventListener("keydown",l)}),(e,l)=>(h(),p(f,{to:"body"},[w("div",X,[w("div",{class:g(["html-preview-frame__backdrop",{"html-preview-frame__backdrop--dark":o.isDark}]),onClick:l[2]||(l[2]=e=>{var t;return null==(t=o.onClose)?void 0:t.call(o)})},[w("div",{class:g(["html-preview-frame",{"html-preview-frame--dark":o.isDark}]),onClick:l[1]||(l[1]=y(()=>{},["stop"]))},[w("div",A,[w("div",G,[l[3]||(l[3]=w("span",{class:"html-preview-frame__dot"},null,-1)),w("span",J,b(o.title||k(t)("common.preview")||"Preview"),1)]),w("button",{type:"button",class:g(["html-preview-frame__close",{"html-preview-frame__close--dark":o.isDark}]),onClick:l[0]||(l[0]=e=>{var t;return null==(t=o.onClose)?void 0:t.call(o)})}," × ",2)]),w("iframe",{class:"html-preview-frame__iframe",sandbox:"allow-scripts allow-same-origin",srcdoc:n.value},null,8,U)],2)],2)])]))}}),[["__scopeId","data-v-296dd89d"]]);let Q=null,Z=null,ee=null,oe=null,te=null,ne=null;const le=/* @__PURE__ */new WeakMap;let ie=0;const ae={key:0,class:"code-block-header flex justify-between items-center px-4 py-0.5 border-b border-gray-400/5",style:{color:"var(--vscode-editor-foreground, var(--markstream-code-fallback-fg))","background-color":"var(--vscode-editor-background, var(--markstream-code-fallback-bg))"}},re={class:"header-left-content flex items-center flex-1 overflow-hidden"},ue=["innerHTML"],se={class:"text-sm font-medium font-mono truncate"},ce={class:"flex items-center gap-x-2"},de=["aria-pressed"],ve=["disabled"],me=["disabled"],pe=["disabled"],he=["aria-label"],fe={key:0,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},we={key:1,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},ge=["aria-pressed"],ye={key:0,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},be={key:1,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},ke=["aria-label"],xe={class:"code-editor-layer"},Me={class:"code-loading-placeholder"},Ce={class:"sr-only","aria-live":"polite",role:"status"},Se="__markstreamMonacoPassiveTouch__",Be=20,Oe=/* @__PURE__ */j(/* @__PURE__ */c({__name:"CodeBlockNode",props:{node:{},isDark:{type:Boolean},loading:{type:Boolean,default:!0},stream:{type:Boolean,default:!0},darkTheme:{default:"dark-plus"},lightTheme:{default:"light-plus"},isShowPreview:{type:Boolean,default:!0},monacoOptions:{},enableFontSizeControl:{type:Boolean,default:!0},minWidth:{default:void 0},maxWidth:{default:void 0},themes:{},showHeader:{type:Boolean,default:!0},showCopyButton:{type:Boolean,default:!0},showExpandButton:{type:Boolean,default:!0},showPreviewButton:{type:Boolean,default:!0},showFontSizeButtons:{type:Boolean,default:!0},customId:{}},emits:["previewCode","copy"],setup(e,{emit:o}){var t;const n=e,l=o;"undefined"!=typeof window&&function(){var e;try{const o=window;if(o[Se])return;const t=null==(e=window.Element)?void 0:e.prototype,n=null==t?void 0:t.addEventListener;if(!t||!n)return;t.addEventListener=function(e,o,t){return"touchstart"===e&&function(e,o){if(!e)return!1;const t=e;return!("function"!=typeof t.closest||!t.closest(".monaco-editor, .monaco-diff-editor")||o&&"object"==typeof o&&"passive"in o)}(this,t)?n.call(this,e,o,function(e){return null==e?{passive:!0}:"boolean"==typeof e?{capture:e,passive:!0}:"object"==typeof e?"passive"in e?e:u(r({},e),{passive:!0}):{passive:!0}}(t)):n.call(this,e,o,t)},o[Se]=!0}catch(o){}}();const i=x(),a=d(()=>{const e=null==i?void 0:i.vnode.props;return!(!e||!e.onPreviewCode&&!e.onPreviewCode)}),{t:c}=N(),v=M(null),f=M(null),y=M(!1),j=M(H(n.node.language)),X=d(()=>$(j.value)),A=M(!0),G=M(!1),J=M(!1),U=M(!1),Oe=M(!1),_e=M(null);let Fe=0;const Pe=D(),Ee=M(null),Te=M("undefined"==typeof window);"undefined"!=typeof window&&C(()=>f.value,e=>{var o;if(null==(o=Ee.value)||o.destroy(),Ee.value=null,!e)return void(Te.value=!1);const t=Pe(e,{rootMargin:"400px"});Ee.value=t,Te.value=t.isVisible.value,t.whenVisible.then(()=>{Te.value=!0})},{immediate:!0}),S(()=>{var e;null==(e=Ee.value)||e.destroy(),Ee.value=null});let ze=null,Ne=null,je=()=>{},He=()=>{},$e=()=>null,De=()=>({getModel:()=>({getLineCount:()=>1}),getOption:()=>14,updateOptions:()=>{}}),Le=()=>({getModel:()=>({getLineCount:()=>1}),getOption:()=>14,updateOptions:()=>{}}),Ye=()=>{},We=()=>{},Ve=null,qe=()=>{var e;return String(null!=(e=n.node.language)?e:"plaintext")},Ie=()=>s(null,null,function*(){});const Re=d(()=>n.node.diff),Xe=d(()=>Re.value?"diff":"single"),Ae=M(Xe.value),Ge=M(!1),Je=d(()=>{var e;const o=null==(e=n.monacoOptions)?void 0:e.wordWrap;return null==o||"off"!==String(o)}),Ue=d(()=>"undefined"!=typeof window&&!Ge.value&&!U.value),Ke=["ui-monospace","SFMono-Regular","SF Mono","Menlo","Monaco","Consolas","Liberation Mono","Courier New","monospace"].join(", "),Qe=M(!1);"undefined"!=typeof window&&s(null,null,function*(){try{const e=yield L();if(!e)return void(Ge.value=!0);const o=e.useMonaco,t=e.detectLanguage;if("function"==typeof t&&(qe=t),"function"==typeof o){const e=Fo(),t=(()=>{const o=Array.isArray(n.themes)?[...n.themes]:[],t=e=>{e&&(o.some(o=>{if(o===e)return!0;const t="object"==typeof o&&o?o.name:void 0,n="object"==typeof e&&e?e.name:void 0;return"string"==typeof o&&"string"==typeof e?o===e:!(!t||!n)&&t===n})||o.push(e))};return t(n.darkTheme),t(n.lightTheme),t(e),o.length?o:void 0})(),l=o(u(r({wordWrap:"on",wrappingIndent:"same",fontSize:Be,fontFamily:Ke,themes:t,theme:e},n.monacoOptions||{}),{onThemeChange(){co()}}));ze=l.createEditor||ze,Ne=l.createDiffEditor||Ne,je=l.updateCode||je,He=l.updateDiff||He,$e=l.getEditor||$e,De=l.getEditorView||De,Le=l.getDiffEditorView||Le,Ye=l.cleanupEditor||Ye,We=l.safeClean||l.cleanupEditor||We,Ie=l.setTheme||Ie,Oe.value=!0,v.value&&(yield Oo(v.value))}}catch(e){Ge.value=!0}});const Ze=M("number"==typeof(null==(t=n.monacoOptions)?void 0:t.fontSize)?n.monacoOptions.fontSize:Be),eo=M(Ze.value),oo=d(()=>{const e=Ze.value,o=eo.value;return"number"==typeof e&&Number.isFinite(e)&&e>0&&"number"==typeof o&&Number.isFinite(o)&&o>0}),to=d(()=>{var e;const o=null==(e=n.monacoOptions)?void 0:e.fontSize;if("number"==typeof o&&Number.isFinite(o)&&o>0)return o;const t=eo.value;return"number"==typeof t&&Number.isFinite(t)&&t>0?t:Be}),no=d(()=>{var e;const o=null==(e=n.monacoOptions)?void 0:e.lineHeight;return"number"==typeof o&&Number.isFinite(o)&&o>0?o:Math.round(1.5*to.value)}),lo=d(()=>{var e;const o=null==(e=n.monacoOptions)?void 0:e.tabSize;return"number"==typeof o&&Number.isFinite(o)&&o>0?o:4}),io=d(()=>{var e;const o=null==(e=n.monacoOptions)?void 0:e.fontFamily,t="string"==typeof o&&o.trim()?o.trim():Ke;return{fontSize:`${to.value}px`,lineHeight:`${no.value}px`,tabSize:lo.value,"--markstream-code-font-family":t}});function ao(){var e,o,t,n,l;try{const i=Re.value?null!=(t=null==(o=null==(e=Le())?void 0:e.getModifiedEditor)?void 0:o.call(e))?t:Le():De(),a=$e(),r=null==(n=null==a?void 0:a.EditorOption)?void 0:n.fontInfo;if(i&&null!=r){const e=null==(l=i.getOption)?void 0:l.call(i,r),o=null==e?void 0:e.fontSize;if("number"==typeof o&&Number.isFinite(o)&&o>0)return o}}catch(i){}try{const e=v.value;if(e){const o=e.querySelector(".view-lines .view-line");if(o)try{if("undefined"!=typeof window&&"function"==typeof window.getComputedStyle){const e=window.getComputedStyle(o).fontSize,t=e&&e.match(/^(\d+(?:\.\d+)?)/);if(t)return Number.parseFloat(t[1])}}catch(i){}}}catch(i){}return null}function ro(e){var o,t;try{const n=$e(),l=null==(o=null==n?void 0:n.EditorOption)?void 0:o.lineHeight;if(null!=l){const o=null==(t=null==e?void 0:e.getOption)?void 0:t.call(e,l);if("number"==typeof o&&o>0)return o}}catch(i){}const n=function(){try{const e=v.value;if(!e)return null;const o=e.querySelector(".view-lines .view-line");if(o){const e=Math.ceil(o.getBoundingClientRect().height);if(e>0)return e}}catch(i){}return null}();if(n&&n>0)return n;const l=Number.isFinite(eo.value)&&eo.value>0?eo.value:Be;return Math.max(12,Math.round(1.35*l))}function uo(){var e;if(Number.isFinite(eo.value)&&eo.value>0&&Number.isFinite(Ze.value))return eo.value;const o=ao();return"number"==typeof(null==(e=n.monacoOptions)?void 0:e.fontSize)?(Ze.value=n.monacoOptions.fontSize,eo.value=n.monacoOptions.fontSize,eo.value):o&&o>0?(Ze.value=o,eo.value=o,o):(Ze.value=Be,eo.value=Be,Be)}function so(){var e,o,t,n,l,i,a,r,u,s,c,d,v,m;try{const p=Re.value?Le():De();if(!p)return null;if(Re.value&&(null==p?void 0:p.getOriginalEditor)&&(null==p?void 0:p.getModifiedEditor)){const v=null==(e=p.getOriginalEditor)?void 0:e.call(p),m=null==(o=p.getModifiedEditor)?void 0:o.call(p);null==(t=null==v?void 0:v.layout)||t.call(v),null==(n=null==m?void 0:m.layout)||n.call(m);const h=(null==(l=null==v?void 0:v.getContentHeight)?void 0:l.call(v))||0,f=(null==(i=null==m?void 0:m.getContentHeight)?void 0:i.call(m))||0,w=Math.max(h,f);if(w>0)return Math.ceil(w+1);const g=(null==(u=null==(r=null==(a=null==v?void 0:v.getModel)?void 0:a.call(v))?void 0:r.getLineCount)?void 0:u.call(r))||1,y=(null==(d=null==(c=null==(s=null==m?void 0:m.getModel)?void 0:s.call(m))?void 0:c.getLineCount)?void 0:d.call(c))||1,b=Math.max(g,y),k=Math.max(ro(v),ro(m));return Math.ceil(b*(k+1.5)+0+1)}if(null==p?void 0:p.getContentHeight){null==(v=null==p?void 0:p.layout)||v.call(p);const e=p.getContentHeight();if(e>0)return Math.ceil(e+1)}const h=null==(m=null==p?void 0:p.getModel)?void 0:m.call(p);let f=1;h&&"function"==typeof h.getLineCount&&(f=h.getLineCount());const w=ro(p);return Math.ceil(f*(w+1.5)+0+1)}catch(p){return null}}function co(){var e,o,t,n,l,i,a,r;const u=v.value,s=f.value;if(!u||!s)return;const c=u.querySelector(".monaco-editor")||u,d=c.querySelector(".monaco-editor-background")||c,m=c.querySelector(".view-lines")||c;let p=null,h=null,w=null;try{"undefined"!=typeof window&&"function"==typeof window.getComputedStyle&&(p=window.getComputedStyle(c),h=d===c?p:window.getComputedStyle(d),w=m===c?p:window.getComputedStyle(m))}catch(M){p=null,h=null,w=null}const g=String(null!=(e=null==p?void 0:p.getPropertyValue("--vscode-editor-foreground"))?e:"").trim(),y=String(null!=(o=null==p?void 0:p.getPropertyValue("--vscode-editor-background"))?o:"").trim(),b=String(null!=(n=null!=(t=null==p?void 0:p.getPropertyValue("--vscode-editor-selectionBackground"))?t:null==p?void 0:p.getPropertyValue("--vscode-editor-hoverHighlightBackground"))?n:"").trim(),k=g||String(null!=(i=null!=(l=null==w?void 0:w.color)?l:null==p?void 0:p.color)?i:"").trim(),x=y||String(null!=(r=null!=(a=null==h?void 0:h.backgroundColor)?a:null==p?void 0:p.backgroundColor)?r:"").trim();k&&s.style.setProperty("--vscode-editor-foreground",k),x&&s.style.setProperty("--vscode-editor-background",x),b&&s.style.setProperty("--vscode-editor-selectionBackground",b)}function vo(){try{const e=v.value;if(!e)return;const o=e.getBoundingClientRect(),t=window.scrollY+o.top,n=so();if(null!=n&&n>0){const l=o.height;e.style.height=`${Math.ceil(n)}px`,e.style.maxHeight="none";const i=Math.ceil(n)-l;0!==i&&t<window.scrollY&&window.scrollBy(0,i)}}catch(e){}}function mo(){var e;try{const o=v.value;if(!o)return;const t=o.getBoundingClientRect(),l=window.scrollY+t.top,i=t.height,a=function(){var e,o;const t=null!=(o=null==(e=n.monacoOptions)?void 0:e.MAX_HEIGHT)?o:500;if("number"==typeof t)return t;const l=String(t).match(/^(\d+(?:\.\d+)?)/);return l?Number.parseFloat(l[1]):500}();if(Fe>0&&(Fe--,null!=_e.value)){const e=Math.min(_e.value,a);o.style.height=`${Math.ceil(e)}px`,o.style.maxHeight=`${Math.ceil(a)}px`,o.style.overflow="auto";const t=Math.ceil(e)-i;return void(0!==t&&l<window.scrollY&&window.scrollBy(0,t))}const r=so();if(null!=r&&r>0){const e=Math.min(r,a);o.style.height=`${Math.ceil(e)}px`,o.style.maxHeight=`${Math.ceil(a)}px`,o.style.overflow="auto";const t=Math.ceil(e)-i;return void(0!==t&&l<window.scrollY&&window.scrollBy(0,t))}if(null!=_e.value){const e=Math.min(_e.value,a);o.style.height=`${Math.ceil(e)}px`,o.style.maxHeight=`${Math.ceil(a)}px`,o.style.overflow="auto";const t=Math.ceil(e)-i;return void(0!==t&&l<window.scrollY&&window.scrollBy(0,t))}const u=Math.ceil((null==(e=o.getBoundingClientRect)?void 0:e.call(o).height)||0);if(u>0){const e=Math.min(u,a);o.style.height=`${Math.ceil(e)}px`,o.style.maxHeight=`${Math.ceil(a)}px`,o.style.overflow="auto";const t=Math.ceil(e)-i;return void(0!==t&&l<window.scrollY&&window.scrollBy(0,t))}const s=Number.parseFloat(o.style.height);if(!Number.isNaN(s)&&s>0){const e=Math.ceil(Math.min(s,a));o.style.height=`${e}px`;const t=e-i;0!==t&&l<window.scrollY&&window.scrollBy(0,t)}else{const e=Math.ceil(a);o.style.height=`${e}px`;const t=e-i;0!==t&&l<window.scrollY&&window.scrollBy(0,t)}o.style.maxHeight=`${Math.ceil(a)}px`,o.style.overflow="auto"}catch(o){}}const po=d(()=>n.isShowPreview&&("html"===j.value||"svg"===j.value));C(()=>n.node.language,e=>{j.value=H(e)}),C(()=>n.node.code,e=>s(null,null,function*(){var o,t;if(!1!==n.stream){if(j.value||(j.value=H(qe(e))),ze&&!J.value&&v.value)try{yield Oo(v.value)}catch(l){}Re.value?He(String(null!=(o=n.node.originalCode)?o:""),String(null!=(t=n.node.updatedCode)?t:""),X.value):je(e,X.value),A.value&&R(()=>vo())}}));const ho=d(()=>{const e=j.value;return e?Y[e]||e.charAt(0).toUpperCase()+e.slice(1):Y[""]||"Plain Text"}),fo=d(()=>W(j.value||"")),wo=d(()=>{const e={},o=e=>{if(null!=e)return"number"==typeof e?`${e}px`:String(e)},t=o(n.minWidth),l=o(n.maxWidth);return t&&(e.minWidth=t),l&&(e.maxWidth=l),e});function go(){return s(this,null,function*(){try{"undefined"!=typeof navigator&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText&&(yield navigator.clipboard.writeText(n.node.code)),y.value=!0,l("copy",n.node.code),setTimeout(()=>{y.value=!1},1e3)}catch(e){console.error("复制失败:",e)}})}function yo(e){return!e||e.disabled}function bo(e,o,t="top"){if(yo(e.currentTarget))return;const l=e,i=null!=(null==l?void 0:l.clientX)&&null!=(null==l?void 0:l.clientY)?{x:l.clientX,y:l.clientY}:void 0;q(e.currentTarget,o,t,!1,i,n.isDark)}function ko(){I()}function xo(e){if(yo(e.currentTarget))return;const o=y.value?c("common.copied")||"Copied":c("common.copy")||"Copy",t=e,l=null!=(null==t?void 0:t.clientX)&&null!=(null==t?void 0:t.clientY)?{x:t.clientX,y:t.clientY}:void 0;q(e.currentTarget,o,"top",!1,l,n.isDark)}function Mo(){A.value=!A.value;const e=Re.value?Le():De(),o=v.value;e&&o&&(A.value?(Bo(!0),o.style.maxHeight="none",o.style.overflow="visible",vo()):(Bo(!1),o.style.overflow="auto",mo()))}function Co(){var e,o,t;if(G.value=!G.value,G.value){if(v.value){const t=Math.ceil((null==(o=(e=v.value).getBoundingClientRect)?void 0:o.call(e).height)||0);t>0&&(_e.value=t)}Bo(!1)}else{A.value&&Bo(!0),v.value&&null!=_e.value&&(v.value.style.height=`${_e.value}px`);const e=Re.value?Le():De();try{null==(t=null==e?void 0:e.layout)||t.call(e)}catch(n){}Fe=2,R(()=>{A.value?vo():mo()})}}function So(){if(!po.value)return;const e=j.value;if(a.value){const o="html"===e?"text/html":"image/svg+xml",t="html"===e?c("artifacts.htmlPreviewTitle")||"HTML Preview":c("artifacts.svgPreviewTitle")||"SVG Preview";return void l("previewCode",{node:n.node,artifactType:o,artifactTitle:t,id:`temp-${e}-${Date.now()}`})}"html"===e&&(Qe.value=!Qe.value)}function Bo(e){var o,t;try{if(Re.value){const t=Le();null==(o=null==t?void 0:t.updateOptions)||o.call(t,{automaticLayout:e})}else{const o=De();null==(t=null==o?void 0:o.updateOptions)||t.call(o,{automaticLayout:e})}}catch(n){}}function Oo(e){if(!ze)return null;if(Ve)return Ve;J.value=!0;const o=s(null,null,function*(){yield function(e){return s(this,null,function*(){var o,t,l;if(!ze)return;Re.value?(We(),Ne?yield Ne(e,String(null!=(o=n.node.originalCode)?o:""),String(null!=(t=n.node.updatedCode)?t:""),X.value):yield ze(e,n.node.code,X.value)):yield ze(e,n.node.code,X.value);const i=Re.value?Le():De();if("number"==typeof(null==(l=n.monacoOptions)?void 0:l.fontSize))null==i||i.updateOptions({fontSize:n.monacoOptions.fontSize,automaticLayout:!1}),Ze.value=n.monacoOptions.fontSize,eo.value=n.monacoOptions.fontSize;else{const e=ao();e&&e>0?(Ze.value=e,eo.value=e):(Ze.value=Be,eo.value=Be)}A.value||G.value||mo(),!1===n.loading&&(yield B(),R(()=>{A.value&&!G.value?vo():G.value||mo()})),yield B(),U.value=!0,co()})}(e)});return Ve=o.finally(()=>{Ve=null}),Ve}C(()=>eo.value,(e,o)=>{const t=Re.value?Le():De();t&&"number"==typeof e&&Number.isFinite(e)&&e>0&&(t.updateOptions({fontSize:e}),A.value&&!G.value&&vo())},{flush:"post",immediate:!1});const _o=C(()=>[v.value,Re.value,n.stream,n.loading,Oe.value,Te.value],e=>s(null,[e],function*([e,o,t,n,l,i]){if(!e||!ze)return;if(!i)return;if(!1===t&&!1!==n)return;const a=Oo(e);if(a){try{yield a}catch(r){U.value=!1}_o()}}));function Fo(){return n.isDark?n.darkTheme:n.lightTheme}C(Xe,(e,o)=>s(null,null,function*(){if(e!==o&&(Ae.value=e,ze&&v.value&&J.value&&(!1!==n.stream||!1===n.loading)&&Te.value))try{U.value=!1,J.value=!1,Ve=null,We(),yield B(),yield Oo(v.value)}catch(t){U.value=!1}})),C(()=>[n.isDark,n.darkTheme,n.lightTheme,Oe.value],()=>{Oe.value&&function(){const e=Fo();e&&function(e,o){const t=function(e){if(null==e)return null;if("string"==typeof e)return e;if("object"==typeof e&&e&&"name"in e)return String(e.name);if("object"==typeof e){const t=le.get(e);if(t)return t;try{const o=JSON.stringify(e);if(o)return le.set(e,o),o}catch(o){}const n="__theme_"+ ++ie;return le.set(e,n),n}return String(e)}(o);return t?(ne=e,Q||te!==t?Q?(oe===t||Z===t||(ee=o,oe=t),Q):(ee=o,oe=t,Q=s(null,null,function*(){for(;oe&&null!=ee;){const t=ee,n=oe;if(ee=null,oe=null,te!==n)try{Z=n,yield(null!=ne?ne:e)(t),te=n}catch(o){}}}).finally(()=>{Q=null,Z=null}),Q):Promise.resolve()):Promise.resolve()}(Ie,e).then(()=>{U.value&&R(()=>co())})}()}),C(()=>[n.monacoOptions,Te.value],()=>{var e,o;if(!ze||!Te.value)return;const t=Re.value?Le():De(),l="number"==typeof(null==(e=n.monacoOptions)?void 0:e.fontSize)?n.monacoOptions.fontSize:Number.isFinite(eo.value)?eo.value:void 0;"number"==typeof l&&Number.isFinite(l)&&l>0&&(null==(o=null==t?void 0:t.updateOptions)||o.call(t,{fontSize:l})),A.value&&!G.value?vo():G.value||mo()},{deep:!0});const Po=C(()=>[n.loading,Te.value],e=>s(null,[e],function*([e,o]){o&&(e||(yield B(),R(()=>{G.value||(A.value?vo():mo()),Po()})))}),{immediate:!0,flush:"post"});return m(()=>{Ye()}),(o,t)=>Ge.value?(h(),p(k(V),{key:0,node:e.node,loading:n.loading},null,8,["node","loading"])):(h(),O("div",{key:1,ref_key:"container",ref:f,style:_(wo.value),class:g(["code-block-container my-4 rounded-lg border overflow-hidden shadow-sm",[n.isDark?"border-gray-700/30 bg-gray-900":"border-gray-200 bg-white",{"is-rendering":n.loading,"is-dark":n.isDark}]])},[n.showHeader?(h(),O("div",ae,[E(o.$slots,"header-left",{},()=>[w("div",re,[w("span",{class:"icon-slot h-4 w-4 flex-shrink-0",innerHTML:fo.value},null,8,ue),w("span",se,b(ho.value),1)])],!0),E(o.$slots,"header-right",{},()=>[w("div",ce,[w("button",{type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]","aria-pressed":G.value,onClick:Co,onMouseenter:t[0]||(t[0]=e=>bo(e,G.value?k(c)("common.expand")||"Expand":k(c)("common.collapse")||"Collapse")),onFocus:t[1]||(t[1]=e=>bo(e,G.value?k(c)("common.expand")||"Expand":k(c)("common.collapse")||"Collapse")),onMouseleave:ko,onBlur:ko},[(h(),O("svg",{style:_({rotate:G.value?"0deg":"90deg"}),xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},[...t[17]||(t[17]=[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m9 18l6-6l-6-6"},null,-1)])],4))],40,de),n.showFontSizeButtons&&n.enableFontSizeControl?(h(),O(T,{key:0},[w("button",{type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]",disabled:!!Number.isFinite(eo.value)&&eo.value<=10,onClick:t[2]||(t[2]=e=>function(){const e=uo(),o=Math.max(10,e-1);eo.value=o}()),onMouseenter:t[3]||(t[3]=e=>bo(e,k(c)("common.decrease")||"Decrease")),onFocus:t[4]||(t[4]=e=>bo(e,k(c)("common.decrease")||"Decrease")),onMouseleave:ko,onBlur:ko},[...t[18]||(t[18]=[w("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12h14"})],-1)])],40,ve),w("button",{type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]",disabled:!oo.value||eo.value===Ze.value,onClick:t[5]||(t[5]=e=>(uo(),void(Number.isFinite(Ze.value)&&(eo.value=Ze.value)))),onMouseenter:t[6]||(t[6]=e=>bo(e,k(c)("common.reset")||"Reset")),onFocus:t[7]||(t[7]=e=>bo(e,k(c)("common.reset")||"Reset")),onMouseleave:ko,onBlur:ko},[...t[19]||(t[19]=[w("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},[w("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[w("path",{d:"M3 12a9 9 0 1 0 9-9a9.75 9.75 0 0 0-6.74 2.74L3 8"}),w("path",{d:"M3 3v5h5"})])],-1)])],40,me),w("button",{type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]",disabled:!!Number.isFinite(eo.value)&&eo.value>=36,onClick:t[8]||(t[8]=e=>function(){const e=uo(),o=Math.min(36,e+1);eo.value=o}()),onMouseenter:t[9]||(t[9]=e=>bo(e,k(c)("common.increase")||"Increase")),onFocus:t[10]||(t[10]=e=>bo(e,k(c)("common.increase")||"Increase")),onMouseleave:ko,onBlur:ko},[...t[20]||(t[20]=[w("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",class:"w-3 h-3"},[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12h14m-7-7v14"})],-1)])],40,pe)],64)):F("",!0),n.showCopyButton?(h(),O("button",{key:1,type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]","aria-label":y.value?k(c)("common.copied")||"Copied":k(c)("common.copy")||"Copy",onClick:go,onMouseenter:t[11]||(t[11]=e=>xo(e)),onFocus:t[12]||(t[12]=e=>xo(e)),onMouseleave:ko,onBlur:ko},[y.value?(h(),O("svg",we,[...t[22]||(t[22]=[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 6L9 17l-5-5"},null,-1)])])):(h(),O("svg",fe,[...t[21]||(t[21]=[w("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[w("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),w("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})],-1)])]))],40,he)):F("",!0),n.showExpandButton?(h(),O("button",{key:2,type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]","aria-pressed":A.value,onClick:Mo,onMouseenter:t[13]||(t[13]=e=>bo(e,A.value?k(c)("common.collapse")||"Collapse":k(c)("common.expand")||"Expand")),onFocus:t[14]||(t[14]=e=>bo(e,A.value?k(c)("common.collapse")||"Collapse":k(c)("common.expand")||"Expand")),onMouseleave:ko,onBlur:ko},[A.value?(h(),O("svg",ye,[...t[23]||(t[23]=[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 3h6v6m0-6l-7 7M3 21l7-7m-1 7H3v-6"},null,-1)])])):(h(),O("svg",be,[...t[24]||(t[24]=[w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m14 10l7-7m-1 7h-6V4M3 21l7-7m-6 0h6v6"},null,-1)])]))],40,ge)):F("",!0),po.value&&n.showPreviewButton?(h(),O("button",{key:3,type:"button",class:"code-action-btn p-2 text-xs rounded-md transition-colors hover:bg-[var(--vscode-editor-selectionBackground)]","aria-label":k(c)("common.preview")||"Preview",onClick:So,onMouseenter:t[15]||(t[15]=e=>bo(e,k(c)("common.preview")||"Preview")),onFocus:t[16]||(t[16]=e=>bo(e,k(c)("common.preview")||"Preview")),onMouseleave:ko,onBlur:ko},[...t[25]||(t[25]=[w("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24"},[w("g",{fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"},[w("path",{d:"M23.628 7.41c-.12-1.172-.08-3.583-.9-4.233c-1.921-1.51-6.143-1.11-8.815-1.19c-3.481-.15-7.193.14-10.625.24a.34.34 0 0 0 0 .67c3.472-.05 7.074-.29 10.575-.09c2.471.15 6.653-.14 8.254 1.16c.4.33.41 2.732.49 3.582a42 42 0 0 1 .08 9.005a13.8 13.8 0 0 1-.45 3.001c-2.42 1.4-19.69 2.381-20.72.55a21 21 0 0 1-.65-4.632a41.5 41.5 0 0 1 .12-7.964c.08 0 7.334.33 12.586.24c2.331 0 4.682-.13 6.764-.21a.33.33 0 0 0 0-.66c-7.714-.16-12.897-.43-19.31.05c.11-1.38.48-3.922.38-4.002a.3.3 0 0 0-.42 0c-.37.41-.29 1.77-.36 2.251s-.14 1.07-.2 1.6a45 45 0 0 0-.36 8.645a21.8 21.8 0 0 0 .66 5.002c1.46 2.702 17.248 1.461 20.95.43c1.45-.4 1.69-.8 1.871-1.95c.575-3.809.602-7.68.08-11.496"}),w("path",{d:"M4.528 5.237a.84.84 0 0 0-.21-1c-.77-.41-1.71.39-1 1.1a.83.83 0 0 0 1.21-.1m2.632-.25c.14-.14.19-.84-.2-1c-.77-.41-1.71.39-1 1.09a.82.82 0 0 0 1.2-.09m2.88 0a.83.83 0 0 0-.21-1c-.77-.41-1.71.39-1 1.09a.82.82 0 0 0 1.21-.09m-4.29 8.735c0 .08.23 2.471.31 2.561a.371.371 0 0 0 .63-.14c0-.09 0 0 .15-1.72a10 10 0 0 0-.11-2.232a5.3 5.3 0 0 1-.26-1.37a.3.3 0 0 0-.54-.24a6.8 6.8 0 0 0-.2 2.33c-1.281-.38-1.121.13-1.131-.42a15 15 0 0 0-.19-1.93c-.16-.17-.36-.17-.51.14a20 20 0 0 0-.43 3.471c.04.773.18 1.536.42 2.272c.26.4.7.22.7-.1c0-.09-.16-.09 0-1.862c.06-1.18-.23-.3 1.16-.76m5.033-2.552c.32-.07.41-.28.39-.37c0-.55-3.322-.34-3.462-.24s-.2.18-.18.28s0 .11 0 .16a3.8 3.8 0 0 0 1.591.361v.82a15 15 0 0 0-.13 3.132c0 .2-.09.94.17 1.16a.34.34 0 0 0 .48 0c.125-.35.196-.718.21-1.09a8 8 0 0 0 .14-3.232c0-.13.05-.7-.1-.89a8 8 0 0 0 .89-.09m5.544-.181a.69.69 0 0 0-.89-.44a2.8 2.8 0 0 0-1.252 1.001a2.3 2.3 0 0 0-.41-.83a1 1 0 0 0-1.6.27a7 7 0 0 0-.35 2.07c0 .571 0 2.642.06 2.762c.14 1.09 1 .51.63.13a17.6 17.6 0 0 1 .38-3.962c.32-1.18.32.2.39.51s.11 1.081.73 1.081s.48-.93 1.401-1.78q.075 1.345 0 2.69a15 15 0 0 0 0 1.811a.34.34 0 0 0 .68 0q.112-.861.11-1.73a16.7 16.7 0 0 0 .12-3.582m1.441-.201c-.05.16-.3 3.002-.31 3.202a6.3 6.3 0 0 0 .21 1.741c.33 1 1.21 1.07 2.291.82a3.7 3.7 0 0 0 1.14-.23c.21-.22.10-.59-.41-.64q-.817.096-1.64.07c-.44-.07-.34 0-.67-4.442q.015-.185 0-.37a.316.316 0 0 0-.23-.38a.316.316 0 0 0-.38.23"})])],-1)])],40,ke)):F("",!0)])],!0)])):F("",!0),P(w("div",xe,[w("div",{ref_key:"codeEditor",ref:v,class:g(["code-editor-container",[e.stream?"":"code-height-placeholder",{"is-hidden":Ue.value}]])},null,2),Ue.value?(h(),p(k(V),{key:0,class:g(["code-pre-fallback",{"is-wrap":Je.value}]),style:_(io.value),node:e.node},null,8,["class","style","node"])):F("",!0)],512),[[z,!(G.value||!e.stream&&e.loading)]]),Qe.value&&!a.value&&po.value&&"html"===j.value?(h(),p(K,{key:1,code:e.node.code,"is-dark":n.isDark,"on-close":()=>Qe.value=!1},null,8,["code","is-dark","on-close"])):F("",!0),P(w("div",Me,[E(o.$slots,"loading",{loading:e.loading,stream:e.stream},()=>[t[26]||(t[26]=w("div",{class:"loading-skeleton"},[w("div",{class:"skeleton-line"}),w("div",{class:"skeleton-line"}),w("div",{class:"skeleton-line short"})],-1))],!0)],512),[[z,!e.stream&&e.loading]]),w("span",Ce,b(y.value?k(c)("common.copied")||"Copied":""),1)],6))}}),[["__scopeId","data-v-9781fcfa"]]);Oe.install=e=>{e.component(Oe.__name,Oe)};export{Oe as default};
